{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { useMediaQuery } from 'react-responsive';\nimport { Layout, message } from 'antd';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport { useIntl } from 'react-intl';\nimport dynamic from 'next/dynamic';\nimport Axios from '../store/services/Axios';\nimport { show } from '../store/userEventListeners/action';\nimport { getPageData } from '../store/pages-data/action';\nimport { removeLocalStorageObj } from '../constants/utils';\nimport { sendOrderSuccess } from '../store/cart/action';\nimport { catalogGet } from '../store/catalog/action';\nvar Content = Layout.Content;\nvar ProductSlider = dynamic(function () {\n  return import('../components/common/ProductSlider');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/common/ProductSlider')];\n    },\n    modules: ['../components/common/ProductSlider']\n  }\n});\nvar MobileProductList = dynamic(function () {\n  return import('../components/mobile/mobile-product-list/MobileProductList');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/mobile/mobile-product-list/MobileProductList')];\n    },\n    modules: ['../components/mobile/mobile-product-list/MobileProductList']\n  }\n});\nvar SelectByAge = dynamic(function () {\n  return import('../components/home/SelectByAge');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/home/SelectByAge')];\n    },\n    modules: ['../components/home/SelectByAge']\n  }\n});\nvar ChooseGift = dynamic(function () {\n  return import('../components/home/ChooseGift');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/home/ChooseGift')];\n    },\n    modules: ['../components/home/ChooseGift']\n  }\n});\nvar MainSlider = dynamic(function () {\n  return import('../components/home/main-slider/MainSlider');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/home/main-slider/MainSlider')];\n    },\n    modules: ['../components/home/main-slider/MainSlider']\n  }\n});\nvar MobileCategoryList = dynamic(function () {\n  return import('../components/mobile/category-list-mobile/CategoryListMobile');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/mobile/category-list-mobile/CategoryListMobile')];\n    },\n    modules: ['../components/mobile/category-list-mobile/CategoryListMobile']\n  }\n});\nvar LazyLoad = dynamic(function () {\n  return import('react-lazyload');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('react-lazyload')];\n    },\n    modules: ['react-lazyload']\n  }\n});\n\nfunction sendGetRequest(token) {\n  return _regeneratorRuntime.async(function sendGetRequest$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(Axios.get(\"/api/user/verifyEmail/\".concat(token)));\n\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n}\n\nfunction changeEmailRequest(token) {\n  return _regeneratorRuntime.async(function changeEmailRequest$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regeneratorRuntime.awrap(Axios.get(\"/api/user/changeEmail/\".concat(token)));\n\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n}\n\nfunction confirmBankOrder(orderId) {\n  return _regeneratorRuntime.async(function confirmBankOrder$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return _regeneratorRuntime.awrap(Axios.get(\"/api/user/checkOrder?orderId=\".concat(orderId)));\n\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n}\n\nfunction Home(_ref) {\n  var token = _ref.token,\n      orderId = _ref.orderId,\n      showAction = _ref.showAction,\n      sendOrderSuccessAction = _ref.sendOrderSuccessAction,\n      pageData = _ref.pageData,\n      lang = _ref.lang,\n      confirmEmailChange = _ref.confirmEmailChange;\n  var idDesktop = useMediaQuery({\n    minWidth: 992\n  });\n\n  var _useIntl = useIntl(),\n      messages = _useIntl.messages;\n\n  useEffect(function () {\n    if (token) {\n      sendGetRequest(token).then(function () {\n        showAction({\n          name: 'loginVisible'\n        });\n      });\n    } else if (orderId) {\n      confirmBankOrder(orderId).then(function () {\n        message.success(messages['local.successText']);\n        removeLocalStorageObj('cart');\n        sendOrderSuccessAction();\n      })[\"catch\"](function () {\n        message.error(messages['local.errorText']);\n      });\n    }\n  }, [token, orderId]);\n  useEffect(function () {\n    if (confirmEmailChange) {\n      changeEmailRequest(confirmEmailChange).then(function () {\n        message.success(messages['local.successText']);\n      });\n    }\n  }, [confirmEmailChange]);\n  return pageData.loading ? __jsx(Content, {\n    className: \"home_page\"\n  }, __jsx(MainSlider, null), __jsx(MobileCategoryList, null)) : __jsx(Content, {\n    className: \"home_page\"\n  }, __jsx(MainSlider, null), __jsx(MobileCategoryList, null), (Array.isArray(pageData === null || pageData === void 0 ? void 0 : pageData.data) ? pageData === null || pageData === void 0 ? void 0 : pageData.data : []).map(function (data) {\n    var _data$products, _data$products$produc, _data$products$produc2, _data$products$produc3;\n\n    if (data.status !== 'off') {\n      if (data.id === 2) {\n        return __jsx(SelectByAge, {\n          key: \"home_page\".concat(data.id)\n        });\n      }\n\n      if (data.id === 5) {\n        return __jsx(ChooseGift, {\n          key: \"home_page\".concat(data.id)\n        });\n      }\n    }\n\n    var products = data === null || data === void 0 ? void 0 : (_data$products = data.products) === null || _data$products === void 0 ? void 0 : _data$products.products;\n    if (!products || products.rows.length === 0 || data.status === 'off') return null;\n    var link = '/catalog?classification=';\n\n    if (data.id === 1) {\n      link += 'isNew';\n    } else if (data.id === 3) {\n      link += 'percent';\n    } else if (data.id === 6) {\n      link += 'bestSeller';\n    } else if (data.id === 4) {\n      link = '/catalog?brand=1';\n    } else link += (_data$products$produc = data.products.products.rows[0]) === null || _data$products$produc === void 0 ? void 0 : (_data$products$produc2 = _data$products$produc.extraFilter) === null || _data$products$produc2 === void 0 ? void 0 : (_data$products$produc3 = _data$products$produc2[0]) === null || _data$products$produc3 === void 0 ? void 0 : _data$products$produc3.id;\n\n    return __jsx(\"div\", {\n      className: \"new_products_slider_section slider_wrapper\",\n      key: \"home_page\".concat(data.id)\n    }, __jsx(\"div\", {\n      className: \"container\"\n    }, __jsx(\"h2\", {\n      className: \"section_title\"\n    }, __jsx(Link, {\n      href: link\n    }, __jsx(\"a\", null, data.names.find(function (_ref2) {\n      var thisLang = _ref2.lang;\n      return thisLang === lang;\n    }).name)))), !idDesktop ? __jsx(MobileProductList, {\n      products: products.rows\n    }) : __jsx(LazyLoad, {\n      height: 375\n    }, __jsx(\"div\", {\n      className: \"container\"\n    }, __jsx(ProductSlider, {\n      products: products.rows\n    }), __jsx(\"div\", {\n      className: \"view_more\"\n    }, __jsx(Link, {\n      href: link\n    }, __jsx(\"a\", null, messages['local.view_more'], __jsx(\"img\", {\n      src: \"/images/icons/next.png\",\n      alt: \" \"\n    })))))));\n  }));\n}\n\nfunction mapStateToProps(_ref3) {\n  var productsList = _ref3.productsList,\n      pageData = _ref3.pageData,\n      lang = _ref3.user.lang;\n  return {\n    productsList: productsList,\n    pageData: pageData,\n    lang: lang\n  };\n}\n\nHome.getInitialProps = function (_ref4) {\n  var query = _ref4.query,\n      store = _ref4.store;\n  var token = query.token,\n      confirmEmailChange = query.confirmEmailChange,\n      orderId = query.orderId;\n  store.dispatch(getPageData({\n    page: 'home'\n  }));\n  return {\n    token: token,\n    confirmEmailChange: confirmEmailChange,\n    orderId: orderId\n  };\n};\n\nexport default connect(mapStateToProps, {\n  showAction: show,\n  sendOrderSuccessAction: sendOrderSuccess,\n  catalogGetAction: catalogGet\n})(Home);","map":null,"metadata":{},"sourceType":"module"}