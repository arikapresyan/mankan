{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport { put, takeLatest, select, call, all } from '@redux-saga/core/effects';\nimport { CancelToken } from 'axios';\nimport Axios from '../services/Axios';\nimport { catalogGet, catalogGetSuccess, catalogGetError } from './action';\nimport { clearFilters, selectCatalogFilters } from '../catalog-filter/reducer';\nimport { selectLang } from '../user/reducer';\nimport { catalogSetFilters } from '../catalog-filter/action';\nimport { CATALOG_PRODUCTS_LIMIT } from './constants';\nlet cancel; // eslint-disable-next-line require-yield\n\nfunction getFilteredDataRequest(data) {\n  return Axios.request({\n    url: '/api/product/fast',\n    method: 'post',\n    data,\n    cancelToken: new CancelToken(c => {\n      cancel = c;\n    })\n  });\n}\n\nfunction getKey(name) {\n  // brand productSex extraFilter productAge productType productUsage\n  switch (name) {\n    case 'age':\n      return 'productAge';\n\n    case 'gender':\n      return 'productSex';\n\n    case 'type':\n      return 'productType';\n\n    case 'brand':\n      return 'brand';\n\n    case 'meaning':\n      return 'productUsage';\n\n    case 'classification':\n      return 'extraFilter';\n\n    default:\n      return null;\n  }\n}\n\nfunction getBackKey(name) {\n  switch (name) {\n    case 'productAge':\n      return 'age';\n\n    case 'productSex':\n      return 'gender';\n\n    case 'productType':\n      return 'type';\n\n    case 'brand':\n      return 'brand';\n\n    case 'productUsage':\n      return 'meaning';\n\n    case 'extraFilter':\n      return 'classification';\n\n    default:\n      return null;\n  }\n}\n\nfunction* workCatalogGet({\n  payload\n}) {\n  try {\n    var _filterClone$gender, _filterClone$gender2, _filterClone$price, _filterClone$price2, _filterClone$classifi, _filterClone$classifi2, _filterClone$classifi3, _filterClone$classifi4, _filterClone$gender3;\n\n    const {\n      page,\n      name,\n      changedNames\n    } = payload || {}; // TODO: remove is triggered\n\n    const selectedPage = page || 1;\n    const filters = yield select(clearFilters);\n    const catalogFilters = yield select(selectCatalogFilters);\n    let lastFilters = {};\n    const filterName = getKey(name);\n\n    if (filterName) {\n      if (filterName && catalogFilters[filterName]) {\n        lastFilters = {\n          [filterName]: catalogFilters[filterName]\n        };\n      }\n    }\n\n    if (changedNames) {\n      changedNames.forEach(n => {\n        const fName = getKey(n);\n\n        if (fName) {\n          if (fName && catalogFilters[fName]) {\n            lastFilters[fName] = catalogFilters[fName];\n          }\n        }\n      });\n    } // brand productSex extraFilter productAge productType productUsage\n\n\n    filters.classification = filters.classification || []; // eslint-disable-next-line no-restricted-globals\n\n    const extraFilterIds = !isNaN(+filters.classification[0]) && filters.classification[0];\n    const filterClone = JSON.parse(JSON.stringify(filters));\n    const lastFilterKeys = [];\n    Object.keys(filterClone).forEach(key => {\n      const indexOfAll = filterClone[key].indexOf('all');\n      lastFilterKeys.push(getKey(key));\n\n      if (indexOfAll !== -1 || !filterClone[key].length) {\n        delete filterClone[key];\n        delete lastFilters[getKey(key)];\n      }\n    });\n    Object.keys(lastFilters).forEach(key => {\n      if (!filterClone[getBackKey(key)]) {\n        delete lastFilters[key];\n      }\n    });\n    const filterToSend = {\n      lang: yield select(selectLang),\n      limit: CATALOG_PRODUCTS_LIMIT,\n      offset: (selectedPage - 1) * CATALOG_PRODUCTS_LIMIT,\n      extraFilterIds,\n      typeIds: filterClone.type,\n      usageIds: filterClone.meaning,\n      ageIds: filterClone.age,\n      brandIds: filterClone.brand,\n      sex: ((_filterClone$gender = filterClone.gender) === null || _filterClone$gender === void 0 ? void 0 : _filterClone$gender[0]) !== 'ALL' ? filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$gender2 = filterClone.gender) === null || _filterClone$gender2 === void 0 ? void 0 : _filterClone$gender2[0] : undefined,\n      minPrice: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$price = filterClone.price) === null || _filterClone$price === void 0 ? void 0 : _filterClone$price[0]) || undefined,\n      maxPrice: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$price2 = filterClone.price) === null || _filterClone$price2 === void 0 ? void 0 : _filterClone$price2[1]) || undefined,\n      percent: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$classifi = filterClone.classification) === null || _filterClone$classifi === void 0 ? void 0 : _filterClone$classifi[0]) === 'percent',\n      bestSeller: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$classifi2 = filterClone.classification) === null || _filterClone$classifi2 === void 0 ? void 0 : _filterClone$classifi2[0]) === 'bestSeller',\n      isNew: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$classifi3 = filterClone.classification) === null || _filterClone$classifi3 === void 0 ? void 0 : _filterClone$classifi3[0]) === 'isNew',\n      priceByAsc: (filterClone === null || filterClone === void 0 ? void 0 : (_filterClone$classifi4 = filterClone.classification) === null || _filterClone$classifi4 === void 0 ? void 0 : _filterClone$classifi4[0]) === 'priceByAsc',\n      searchWord: catalogFilters.searchWord\n    };\n\n    if (Array.isArray((_filterClone$gender3 = filterClone.gender) === null || _filterClone$gender3 === void 0 ? void 0 : _filterClone$gender3[0])) {\n      delete filterToSend.sex;\n    }\n\n    if (cancel !== undefined) {\n      cancel();\n    }\n\n    const {\n      data: {\n        filters: newFilters\n      }\n    } = yield call(getFilteredDataRequest, filterToSend),\n          restData = _objectWithoutProperties((yield call(getFilteredDataRequest, filterToSend)).data, [\"filters\"]);\n\n    yield all([put(catalogGetSuccess({\n      products: restData.result.rows,\n      pagesCount: restData.pages,\n      page: selectedPage\n    }))]);\n\n    if (restData.result.rows.length > 0) {\n      yield put(catalogSetFilters({\n        filters: _objectSpread({\n          productAge: newFilters.age,\n          productType: newFilters.type,\n          productSex: newFilters.productSex,\n          extraFilter: newFilters.extraFilter,\n          productUsage: newFilters.usage,\n          brand: newFilters.brand,\n          searchWord: catalogFilters.searchWord\n        }, lastFilters)\n      }));\n    }\n  } catch (error) {\n    yield put(catalogGetError());\n  }\n}\n\nfunction* watchCatalogGet() {\n  yield takeLatest(catalogGet, workCatalogGet);\n}\n\nexport { watchCatalogGet, workCatalogGet };","map":{"version":3,"sources":["/var/www/mankan-front/store/catalog/saga.js"],"names":["put","takeLatest","select","call","all","CancelToken","Axios","catalogGet","catalogGetSuccess","catalogGetError","clearFilters","selectCatalogFilters","selectLang","catalogSetFilters","CATALOG_PRODUCTS_LIMIT","cancel","getFilteredDataRequest","data","request","url","method","cancelToken","c","getKey","name","getBackKey","workCatalogGet","payload","page","changedNames","selectedPage","filters","catalogFilters","lastFilters","filterName","forEach","n","fName","classification","extraFilterIds","isNaN","filterClone","JSON","parse","stringify","lastFilterKeys","Object","keys","key","indexOfAll","indexOf","push","length","filterToSend","lang","limit","offset","typeIds","type","usageIds","meaning","ageIds","age","brandIds","brand","sex","gender","undefined","minPrice","price","maxPrice","percent","bestSeller","isNew","priceByAsc","searchWord","Array","isArray","newFilters","restData","products","result","rows","pagesCount","pages","productAge","productType","productSex","extraFilter","productUsage","usage","error","watchCatalogGet"],"mappings":"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","sourcesContent":["// eslint-disable-next-line import/no-extraneous-dependencies\nimport {\n  put, takeLatest, select, call, all,\n} from '@redux-saga/core/effects';\n\n\nimport { CancelToken } from 'axios';\nimport Axios from '../services/Axios';\nimport {\n  catalogGet,\n  catalogGetSuccess,\n  catalogGetError,\n\n} from './action';\nimport { clearFilters, selectCatalogFilters } from '../catalog-filter/reducer';\nimport { selectLang } from '../user/reducer';\nimport { catalogSetFilters } from '../catalog-filter/action';\nimport { CATALOG_PRODUCTS_LIMIT } from './constants';\n\n\nlet cancel;\n\n\n// eslint-disable-next-line require-yield\nfunction getFilteredDataRequest(data) {\n  return Axios.request({\n    url: '/api/product/fast',\n    method: 'post',\n    data,\n    cancelToken: new CancelToken(((c) => {\n      cancel = c;\n    })),\n  });\n}\n\nfunction getKey(name) {\n  // brand productSex extraFilter productAge productType productUsage\n  switch (name) {\n    case 'age':\n      return 'productAge';\n    case 'gender':\n      return 'productSex';\n    case 'type':\n      return 'productType';\n    case 'brand':\n      return 'brand';\n    case 'meaning':\n      return 'productUsage';\n    case 'classification':\n      return 'extraFilter';\n\n    default:\n      return null;\n  }\n}\n\nfunction getBackKey(name) {\n  switch (name) {\n    case 'productAge':\n      return 'age';\n    case 'productSex':\n      return 'gender';\n    case 'productType':\n      return 'type';\n    case 'brand':\n      return 'brand';\n    case 'productUsage':\n      return 'meaning';\n    case 'extraFilter':\n      return 'classification';\n\n    default:\n      return null;\n  }\n}\nfunction* workCatalogGet({ payload }) {\n  try {\n    const { page, name, changedNames } = (payload || {}); // TODO: remove is triggered\n    const selectedPage = page || 1;\n\n    const filters = yield select(clearFilters);\n\n\n    const catalogFilters = yield select(selectCatalogFilters);\n\n\n    let lastFilters = {};\n    const filterName = getKey(name);\n    if (filterName) {\n      if (filterName && catalogFilters[filterName]) {\n        lastFilters = {\n          [filterName]: catalogFilters[filterName],\n        };\n      }\n    }\n\n    if (changedNames) {\n      changedNames.forEach((n) => {\n        const fName = getKey(n);\n        if (fName) {\n          if (fName && catalogFilters[fName]) {\n            lastFilters[fName] = catalogFilters[fName];\n          }\n        }\n      });\n    }\n    // brand productSex extraFilter productAge productType productUsage\n\n    filters.classification = filters.classification || [];\n    // eslint-disable-next-line no-restricted-globals\n    const extraFilterIds = !isNaN(+filters.classification[0]) && filters.classification[0];\n\n    const filterClone = JSON.parse(JSON.stringify(filters));\n\n    const lastFilterKeys = [];\n    Object.keys(filterClone).forEach((key) => {\n      const indexOfAll = filterClone[key].indexOf('all');\n      lastFilterKeys.push(getKey(key));\n      if (indexOfAll !== -1 || !filterClone[key].length) {\n        delete filterClone[key];\n        delete lastFilters[getKey(key)];\n      }\n    });\n\n    Object.keys(lastFilters).forEach((key) => {\n      if (!filterClone[getBackKey(key)]) {\n        delete lastFilters[key];\n      }\n    });\n\n    const filterToSend = {\n      lang: yield select(selectLang),\n      limit: CATALOG_PRODUCTS_LIMIT,\n      offset: (selectedPage - 1) * CATALOG_PRODUCTS_LIMIT,\n      extraFilterIds,\n      typeIds: filterClone.type,\n      usageIds: filterClone.meaning,\n      ageIds: filterClone.age,\n      brandIds: filterClone.brand,\n      sex: filterClone.gender?.[0] !== 'ALL' ? filterClone?.gender?.[0] : undefined,\n      minPrice: filterClone?.price?.[0] || undefined,\n      maxPrice: filterClone?.price?.[1] || undefined,\n      percent: filterClone?.classification?.[0] === 'percent',\n      bestSeller: filterClone?.classification?.[0] === 'bestSeller',\n      isNew: filterClone?.classification?.[0] === 'isNew',\n      priceByAsc: filterClone?.classification?.[0] === 'priceByAsc',\n      searchWord: catalogFilters.searchWord,\n    };\n    if (Array.isArray(filterClone.gender?.[0])) {\n      delete filterToSend.sex;\n    }\n\n    if (cancel !== undefined) {\n      cancel();\n    }\n\n\n    const { data: { filters: newFilters, ...restData } } = yield call(getFilteredDataRequest, filterToSend);\n\n\n    yield all([\n      put(catalogGetSuccess({\n        products: restData.result.rows,\n        pagesCount: restData.pages,\n        page: selectedPage,\n      })),\n    ]);\n\n\n    if (restData.result.rows.length > 0) {\n      yield put(catalogSetFilters({\n        filters: {\n          productAge: newFilters.age,\n          productType: newFilters.type,\n          productSex: newFilters.productSex,\n          extraFilter: newFilters.extraFilter,\n          productUsage: newFilters.usage,\n          brand: newFilters.brand,\n          searchWord: catalogFilters.searchWord,\n          ...lastFilters,\n        },\n      }));\n    }\n  } catch (error) {\n    yield put(catalogGetError());\n  }\n}\n\nfunction* watchCatalogGet() {\n  yield takeLatest(catalogGet, workCatalogGet);\n}\n\nexport { watchCatalogGet, workCatalogGet };\n"]},"metadata":{},"sourceType":"module"}