{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { Layout } from 'antd';\nimport { useIntl } from 'react-intl';\nimport { connect, useSelector, useDispatch } from 'react-redux';\nimport { UserProfileTab, AccompanyingProductList, ProductSlider } from '../../components';\nimport { getPageData } from '../../store/pages-data/action';\nimport { selectViewedProducts } from '../../store/viewed-products/reducer';\nimport { selectAuthorized, selectLang } from '../../store/user/reducer';\nimport { getViewedProducts } from '../../store/viewed-products/action';\nimport { getDataListByPagination } from '../../store/data-by-pagination/action';\nimport PagesLoader from '../../components/pages-loader/PagesLoader';\nvar Content = Layout.Content;\n\nvar getNextBonusPercent = function getNextBonusPercent(boughtSum) {\n  boughtSum += 0;\n\n  if (boughtSum < 200000) {\n    return 3;\n  }\n\n  if (boughtSum >= 200000 && boughtSum < 500000) {\n    return 4;\n  }\n\n  return 4;\n};\n\nvar untilNextPercent = function untilNextPercent(sum) {\n  if (sum < 200000) {\n    return 200000 - sum;\n  }\n\n  if (sum >= 200000 && sum < 500000) {\n    return 500000 - sum;\n  }\n\n  return 0;\n};\n\nfunction UserProfile(_ref) {\n  var pageData = _ref.pageData,\n      user = _ref.user,\n      buyProductList = _ref.buyProductList,\n      getDataListByPaginationAction = _ref.getDataListByPaginationAction;\n\n  var _useIntl = useIntl(),\n      messages = _useIntl.messages;\n\n  var _useSelector = useSelector(selectViewedProducts),\n      viewedProducts = _useSelector.data,\n      loading = _useSelector.loading;\n\n  var dispatch = useDispatch();\n  var isAuth = useSelector(selectAuthorized);\n  var lang = useSelector(selectLang);\n  useEffect(function () {\n    dispatch(getViewedProducts({\n      limit: 12\n    }));\n    getDataListByPaginationAction({\n      page: buyProductList.page,\n      name: 'buyProductList'\n    });\n  }, [lang]);\n  if (!pageData.data || !isAuth) return __jsx(PagesLoader, null);\n  var nextPercent = getNextBonusPercent(user.boughtSum);\n  return __jsx(Content, {\n    className: \"profile_page\"\n  }, __jsx(\"div\", {\n    className: \"profile_tab_section p_t_30\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"h2\", {\n    className: \"section_title\"\n  }, messages['local.my_profile']), __jsx(UserProfileTab, {\n    nextBonusPercent: nextPercent,\n    untilNextBonusPercent: untilNextPercent(user.boughtSum),\n    bonusPercent: user.bonusPercent || 0,\n    bonus: user.bonus || 0,\n    buyProductList: buyProductList,\n    getDataListByPaginationAction: getDataListByPaginationAction\n  }))), __jsx(\"div\", {\n    className: \"slider_wrapper\"\n  }, !loading && __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"h2\", {\n    className: \"section_title\"\n  }, messages['local.viewed_products']), __jsx(ProductSlider, {\n    products: viewedProducts\n  }), __jsx(AccompanyingProductList, {\n    products: viewedProducts\n  }))));\n}\n\nUserProfile.getInitialProps = function _callee(_ref2) {\n  var store;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          store = _ref2.store;\n          store.dispatch(getPageData({\n            page: 'profile'\n          })); // store.dispatch(getDataListByPagination({ name: 'buyProductList' }));\n\n          return _context.abrupt(\"return\", {});\n\n        case 3:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nfunction mapStateToProps(_ref3) {\n  var pageData = _ref3.pageData,\n      user = _ref3.user,\n      buyProductList = _ref3.dataByPagination.buyProductList;\n  return {\n    pageData: pageData,\n    user: user,\n    buyProductList: buyProductList\n  };\n}\n\nexport default connect(mapStateToProps, {\n  getDataListByPaginationAction: getDataListByPagination\n})(UserProfile);","map":null,"metadata":{},"sourceType":"module"}