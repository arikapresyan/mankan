{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { takeEvery, put, all, call, select } from '@redux-saga/core/effects';\nimport Router from 'next/router';\nimport message from 'antd/lib/message';\nimport Axios from '../services/Axios';\nimport { registration, loginSuccess, logoutSuccess, login, setLang, authorizationError, resetUserReducer, logout, authorizationLoading, getUserData, getUserDataSuccess, getUserDataError } from './action';\nimport { hideAll } from '../userEventListeners/action';\nimport { wishlistPopulate } from '../wishlist/action';\nimport { C_TOKEN, removeLocalStorageObj } from '../../constants/utils';\nimport { populateCart } from '../cart/action';\nimport { selectAuthorized, selectLang, selectUser } from './reducer';\nimport { getPageData } from '../pages-data/action';\nimport { deleteCookie, getCookie, setCookie } from '../../utils/cookies';\n\nfunction loginRequest(params) {\n  return Axios.request({\n    method: 'post',\n    url: '/api/user/signIn',\n    data: params\n  });\n}\n\nfunction* workLogin({\n  payload: {\n    emailOrPhone,\n    password,\n    rememberMe\n  }\n}) {\n  try {\n    const lang = yield select(selectLang);\n    yield put(authorizationLoading());\n    const {\n      data: {\n        token,\n        result\n      }\n    } = yield call(loginRequest, {\n      userName: emailOrPhone,\n      password,\n      rememberMe,\n      lang\n    });\n\n    if (rememberMe) {\n      setCookie(C_TOKEN, token, {\n        'max-age': 100 * 24 * 60 * 60\n      });\n    } else {\n      setCookie(C_TOKEN, token);\n    }\n\n    yield put(loginSuccess(_objectSpread({}, result)));\n    removeLocalStorageObj('cart');\n    removeLocalStorageObj('products');\n    yield put(getPageData({}));\n    yield put(wishlistPopulate());\n    yield put(populateCart());\n  } catch (error) {\n    var _error$response, _error$response$data;\n\n    const errorMessage = (error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Something went wrong';\n    yield all([put(authorizationError({\n      errorText: errorMessage\n    })), put(resetUserReducer())]);\n  }\n}\n\nfunction* watchLogin() {\n  yield takeEvery(login, workLogin);\n}\n\nfunction registrationRequest(params) {\n  return Axios.request({\n    method: 'post',\n    url: '/api/user/signUp',\n    data: params\n  });\n}\n\nfunction* workRegistration({\n  payload: {\n    email,\n    password,\n    phone,\n    agreeTerms,\n    name,\n    surname,\n    successText = 'Please, confirm email'\n  }\n}) {\n  yield put(authorizationLoading());\n\n  try {\n    yield call(registrationRequest, {\n      email,\n      password,\n      retryPassword: password,\n      phone,\n      agreeTerms,\n      firstName: name,\n      lastName: surname,\n      isAcceptedRules: agreeTerms\n    });\n    message.success({\n      content: successText,\n      duration: 5\n    });\n    yield all([put(hideAll()), put(resetUserReducer())]);\n  } catch (error) {\n    var _error$response2, _error$response2$data;\n\n    yield all([put(authorizationError({\n      errorText: (error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'No server response'\n    })), put(resetUserReducer())]);\n  }\n}\n\nfunction* watchRegistration() {\n  yield takeEvery(registration, workRegistration);\n}\n\nfunction getUserDataRequest(token) {\n  return Axios.request({\n    method: 'get',\n    url: `/api/user/info/${token}`\n  });\n}\n\nfunction* workGetUserData() {\n  const token = getCookie(C_TOKEN);\n\n  try {\n    if (!token) throw new Error();\n    const {\n      data: {\n        result\n      }\n    } = yield call(getUserDataRequest, token);\n    yield put(getUserDataSuccess());\n    yield put(loginSuccess(_objectSpread({}, result)));\n    localStorage.setItem('lang', result.lang);\n  } catch (error) {\n    if (error.response) {\n      localStorage.removeItem('cart');\n      sessionStorage.removeItem('cart');\n      localStorage.removeItem('products');\n      sessionStorage.removeItem('products');\n    }\n\n    deleteCookie(C_TOKEN);\n    yield put(getUserDataError());\n  }\n\n  try {\n    yield all([put(wishlistPopulate()), put(populateCart())]);\n  } catch (error) {}\n}\n\nfunction* watchGetUserData() {\n  yield takeEvery(getUserData, workGetUserData);\n}\n\nfunction* workLogout() {\n  try {\n    const user = yield select(selectUser);\n    if (!user.id) return;\n    deleteCookie(C_TOKEN);\n    localStorage.removeItem('products');\n    localStorage.removeItem('cart');\n    Router.push('/');\n    yield put(logoutSuccess());\n    yield put(wishlistPopulate());\n    yield put(populateCart());\n  } catch (error) {\n    yield put(authorizationError({\n      errorText: 'logout error'\n    }));\n  }\n}\n\nfunction changeLangRequest(data) {\n  return Axios.request({\n    url: '/api/user/changeLang',\n    method: 'put',\n    data\n  });\n}\n\nfunction* workSetLang({\n  payload\n}) {\n  try {\n    const isAuth = yield select(selectAuthorized);\n\n    if (isAuth) {\n      yield call(changeLangRequest, payload);\n    }\n\n    localStorage.setItem('lang', payload.lang);\n  } catch (e) {}\n}\n\nfunction* watchSetLang() {\n  yield takeEvery(setLang, workSetLang);\n}\n\nfunction* watchLogout() {\n  yield takeEvery(logout, workLogout);\n}\n\nexport { watchLogin, watchRegistration, watchLogout, watchGetUserData, watchSetLang };","map":{"version":3,"sources":["/var/www/mankan-front/store/user/saga.js"],"names":["takeEvery","put","all","call","select","Router","message","Axios","registration","loginSuccess","logoutSuccess","login","setLang","authorizationError","resetUserReducer","logout","authorizationLoading","getUserData","getUserDataSuccess","getUserDataError","hideAll","wishlistPopulate","C_TOKEN","removeLocalStorageObj","populateCart","selectAuthorized","selectLang","selectUser","getPageData","deleteCookie","getCookie","setCookie","loginRequest","params","request","method","url","data","workLogin","payload","emailOrPhone","password","rememberMe","lang","token","result","userName","error","errorMessage","response","errorText","watchLogin","registrationRequest","workRegistration","email","phone","agreeTerms","name","surname","successText","retryPassword","firstName","lastName","isAcceptedRules","success","content","duration","watchRegistration","getUserDataRequest","workGetUserData","Error","localStorage","setItem","removeItem","sessionStorage","watchGetUserData","workLogout","user","id","push","changeLangRequest","workSetLang","isAuth","e","watchSetLang","watchLogout"],"mappings":"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","sourcesContent":["import {\n  takeEvery, put, all, call, select,\n} from '@redux-saga/core/effects';\nimport Router from 'next/router';\nimport  message  from 'antd/lib/message';\nimport Axios from '../services/Axios';\nimport {\n  registration,\n  loginSuccess,\n  logoutSuccess,\n  login,\n  setLang,\n  authorizationError,\n  resetUserReducer,\n  logout,\n  authorizationLoading,\n  getUserData,\n  getUserDataSuccess,\n  getUserDataError,\n} from './action';\nimport { hideAll } from '../userEventListeners/action';\nimport { wishlistPopulate } from '../wishlist/action';\nimport { C_TOKEN, removeLocalStorageObj } from '../../constants/utils';\nimport { populateCart } from '../cart/action';\nimport { selectAuthorized, selectLang, selectUser } from './reducer';\nimport { getPageData } from '../pages-data/action';\nimport { deleteCookie, getCookie, setCookie } from '../../utils/cookies';\n\n\nfunction loginRequest(params) {\n  return Axios.request({\n    method: 'post',\n    url: '/api/user/signIn',\n    data: params,\n  });\n}\n\nfunction* workLogin({\n  payload: {\n    emailOrPhone,\n    password,\n    rememberMe,\n  },\n}) {\n  try {\n    const lang = yield select(selectLang);\n    yield put(authorizationLoading());\n    const { data: { token, result } } = yield call(loginRequest,\n      {\n        userName: emailOrPhone,\n        password,\n        rememberMe,\n        lang,\n      });\n    if (rememberMe) {\n      setCookie(C_TOKEN, token, { 'max-age': 100 * 24 * 60 * 60 });\n    } else {\n      setCookie(C_TOKEN, token);\n    }\n\n    yield put(\n      loginSuccess({\n        ...result,\n      }),\n    );\n\n    removeLocalStorageObj('cart');\n    removeLocalStorageObj('products');\n    yield put(getPageData({}));\n    yield put(wishlistPopulate());\n    yield put(populateCart());\n  } catch (error) {\n    const errorMessage = error?.response?.data?.message || 'Something went wrong';\n    yield all([\n      put(\n        authorizationError({\n          errorText: errorMessage,\n        }),\n      ),\n      put(\n        resetUserReducer(),\n      ),\n    ]);\n  }\n}\n\nfunction* watchLogin() {\n  yield takeEvery(login, workLogin);\n}\n\nfunction registrationRequest(params) {\n  return Axios.request({\n    method: 'post',\n    url: '/api/user/signUp',\n    data: params,\n  });\n}\n\nfunction* workRegistration({\n  payload: {\n    email,\n    password,\n    phone,\n    agreeTerms,\n    name,\n    surname,\n    successText = 'Please, confirm email',\n  },\n}) {\n  yield put(authorizationLoading());\n\n  try {\n    yield call(registrationRequest, {\n      email,\n      password,\n      retryPassword: password,\n      phone,\n      agreeTerms,\n      firstName: name,\n      lastName: surname,\n      isAcceptedRules: agreeTerms,\n    });\n    message.success({ content: successText, duration: 5 });\n\n    yield all([\n      put(hideAll()),\n      put(resetUserReducer()),\n    ]);\n  } catch (error) {\n    yield all([\n      put(\n        authorizationError({\n          errorText: error?.response?.data?.message || 'No server response',\n        }),\n      ),\n      put(\n        resetUserReducer(),\n      ),\n    ]);\n  }\n}\nfunction* watchRegistration() {\n  yield takeEvery(registration, workRegistration);\n}\n\nfunction getUserDataRequest(token) {\n  return Axios.request({\n    method: 'get',\n    url: `/api/user/info/${token}`,\n  });\n}\n\nfunction* workGetUserData() {\n  const token = getCookie(C_TOKEN);\n\n  try {\n    if (!token) throw new Error();\n    const { data: { result } } = yield call(getUserDataRequest, token);\n\n    yield put(getUserDataSuccess());\n    yield put(loginSuccess({ ...result }));\n    localStorage.setItem('lang', result.lang);\n  } catch (error) {\n    if (error.response) {\n      localStorage.removeItem('cart');\n      sessionStorage.removeItem('cart');\n      localStorage.removeItem('products');\n      sessionStorage.removeItem('products');\n    }\n    deleteCookie(C_TOKEN);\n    yield put(getUserDataError());\n  }\n\n  try {\n    yield all([\n      put(wishlistPopulate()),\n      put(populateCart()),\n    ]);\n  } catch (error) {\n  }\n}\n\n\nfunction* watchGetUserData() {\n  yield takeEvery(getUserData, workGetUserData);\n}\n\n\nfunction* workLogout() {\n  try {\n    const user = yield select(selectUser);\n    if (!user.id) return;\n    deleteCookie(C_TOKEN);\n    localStorage.removeItem('products');\n    localStorage.removeItem('cart');\n    Router.push('/');\n    yield put(logoutSuccess());\n    yield put(wishlistPopulate());\n    yield put(populateCart());\n  } catch (error) {\n    yield put(authorizationError({ errorText: 'logout error' }));\n  }\n}\nfunction changeLangRequest(data) {\n  return Axios.request({\n    url: '/api/user/changeLang',\n    method: 'put',\n    data,\n  });\n}\n\nfunction* workSetLang({ payload }) {\n  try {\n    const isAuth = yield select(selectAuthorized);\n    if (isAuth) {\n      yield call(changeLangRequest, payload);\n    }\n    localStorage.setItem('lang', payload.lang);\n  } catch (e) {\n  }\n}\nfunction* watchSetLang() {\n  yield takeEvery(setLang, workSetLang);\n}\nfunction* watchLogout() {\n  yield takeEvery(logout, workLogout);\n}\nexport {\n  watchLogin,\n  watchRegistration,\n  watchLogout,\n  watchGetUserData,\n  watchSetLang,\n};\n"]},"metadata":{},"sourceType":"module"}