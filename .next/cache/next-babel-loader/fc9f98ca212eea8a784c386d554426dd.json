{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport dynamic from 'next/dynamic';\nimport Layout from 'antd/lib/layout';\nimport Row from 'antd/lib/row';\nimport Col from 'antd/lib/col';\nimport Button from 'antd/lib/button';\nimport { connect } from 'react-redux';\nimport { useIntl } from 'react-intl';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport { Breadcrumb, ViewedProductsList } from '../../components';\nimport FilterWrapper from '../../components/mobile/filter-list-sidebar/FilterListWrapper';\nimport { toggleVisibility } from '../../store/userEventListeners/action';\nimport { resetCatalogFilterReducer, catalogFilterSetValues } from '../../store/catalog-filter/action';\nimport { catalogGet } from '../../store/catalog/action';\nimport { getIsUserFilter, clearFilters, selectCatalogFilters } from '../../store/catalog-filter/reducer';\nimport IndexFilterList from '../../components/catalog/index-filter-list/IndexFilterList';\nimport CatalogLoader from '../../components/catalog/catalog-loader/CatalogLoader';\nimport ProductList from '../../components/catalog/ProductList';\nvar Pagination = dynamic(function () {\n  return import('antd/lib/pagination/index');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('antd/lib/pagination/index')];\n    },\n    modules: ['antd/lib/pagination/index']\n  }\n});\nvar AccompanyingProductList = dynamic(function () {\n  return import('../../components/common/AccompanyingProductList');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../../components/common/AccompanyingProductList')];\n    },\n    modules: ['../../components/common/AccompanyingProductList']\n  }\n});\nvar CatalogEmpty = dynamic(function () {\n  return import('../../components/catalog/catalog-empty/CatalogEmpty');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../../components/catalog/catalog-empty/CatalogEmpty')];\n    },\n    modules: ['../../components/catalog/catalog-empty/CatalogEmpty']\n  }\n});\n\nfunction itemRender(current, type, originalBattery) {\n  if (type === 'prev') {\n    return __jsx(\"a\", null, \"Previous\");\n  }\n\n  if (type === 'next') {\n    return __jsx(\"a\", null, \"Next\");\n  }\n\n  return originalBattery;\n}\n\nfunction Catalog(_ref) {\n  var toggleVisibilityAction = _ref.toggleVisibilityAction,\n      products = _ref.products,\n      pagesCount = _ref.pagesCount,\n      page = _ref.page,\n      catalogGetAction = _ref.catalogGetAction,\n      loading = _ref.loading,\n      resetCatalogFilterReducerAction = _ref.resetCatalogFilterReducerAction,\n      lang = _ref.lang,\n      titleDescription = _ref.titleDescription;\n\n  var _useIntl = useIntl(),\n      formatMessage = _useIntl.formatMessage,\n      messages = _useIntl.messages;\n\n  var _useState = useState(0),\n      count = _useState[0],\n      setCount = _useState[1];\n\n  var router = useRouter();\n  useEffect(function () {\n    return function () {\n      resetCatalogFilterReducerAction({\n        resetSearchWord: true\n      });\n      catalogGetAction();\n    };\n  }, []);\n  useEffect(function () {\n    var changeHandler = function changeHandler(route) {\n      if (route !== '/catalog') {\n        resetCatalogFilterReducerAction({\n          resetSearchWord: true\n        });\n      }\n    };\n\n    router.events.on('routeChangeStart', changeHandler);\n    return function () {\n      return router.events.off('routeChangeStart', changeHandler);\n    };\n  }, []);\n\n  function changePage(clickedPage) {\n    window.scrollTo(0, 0);\n    catalogGetAction({\n      page: clickedPage\n    });\n  }\n\n  useEffect(function () {\n    if (count === 1) {\n      catalogGetAction({\n        page: page\n      });\n    }\n\n    setCount(1);\n  }, [lang]);\n  console.log({\n    pagesCount: pagesCount\n  });\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, titleDescription.title), __jsx(\"meta\", {\n    name: \"description\",\n    content: titleDescription.description\n  })), __jsx(Layout.Content, {\n    className: \"catalog_page\",\n    key: \"content\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"top_content\"\n  }, __jsx(Breadcrumb, null), __jsx(\"div\", {\n    className: \"delivery_terms\"\n  }, formatMessage({\n    id: 'local.free_shipping_message'\n  }, {\n    price: __jsx(\"span\", {\n      className: \"toChangePrice\"\n    }, \"20000\", ' ', formatMessage({\n      id: 'local.dr'\n    }), '.')\n  }))), __jsx(Row, {\n    gutter: [32, {\n      xs: 32,\n      sm: 32,\n      md: 32,\n      lg: 32\n    }]\n  }, __jsx(Col, {\n    className: \"filter_col\",\n    md: 24,\n    lg: 8,\n    xl: 8,\n    xxl: 7\n  }, __jsx(\"div\", {\n    className: \"filter_wrapper\"\n  }, __jsx(IndexFilterList, null)), __jsx(FilterWrapper, null), __jsx(ViewedProductsList, {\n    key: \"ViewedProductsList\"\n  })), __jsx(Col, {\n    className: \"prod_list_col\",\n    md: 24,\n    lg: 16,\n    xl: 16,\n    xxl: 17\n  }, loading ? __jsx(CatalogLoader, null) : __jsx(React.Fragment, null, pagesCount === 0 && __jsx(CatalogEmpty, null), __jsx(ProductList, {\n    products: products\n  }), __jsx(AccompanyingProductList, {\n    products: products\n  }), pagesCount > 1 && __jsx(Pagination, {\n    total: pagesCount * 10,\n    current: page,\n    itemRender: itemRender,\n    onChange: changePage\n  })))), __jsx(Button, {\n    type: \"primary\",\n    className: \"filter_btn\",\n    onClick: function onClick() {\n      return toggleVisibilityAction({\n        name: 'isFilterListOpen'\n      });\n    }\n  }, __jsx(\"img\", {\n    src: \"/images/icons/controls.png\",\n    alt: \"\"\n  }), messages['local.filter']))));\n}\n\nCatalog.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n    var store, query, age, gender, classification, type, brand, meaning, _query$searchWord, searchWord, filter, titleDescription, titleDescriptionKey, state, isUserFilter, filters;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            store = _ref2.store, query = _ref2.query;\n            age = query.age, gender = query.gender, classification = query.classification, type = query.type, brand = query.brand, meaning = query.meaning, _query$searchWord = query.searchWord, searchWord = _query$searchWord === void 0 ? '' : _query$searchWord;\n            filter = {};\n            titleDescription = {\n              age: {\n                title: 'Նորածիններին',\n                description: 'Chicco, Fisher Price, Polesie ապրանքանիշերի մոբիլներ, քայլասայլակներ, խաղագորգեր, երաժշտական խաղալիքներ եւ այլ հանրաճանաչ բրենդների լայն տեսականի նորածինների համար...'\n              },\n              BOY: {\n                title: 'Տղաներին',\n                description: 'Մեքենաներ, զենքեր, հերոսներ եւ այլ հետաքրքիր ու ժամանցային խաղեր տղաների համար...'\n              },\n              GIRL: {\n                title: 'Աղջիկներին',\n                description: 'Տիկնիկներ, զարդասեղաններ, մանկական կոսմետիկա, ստեղծագործական եւ այլ հետաքրքիր ու զարգացնող խաղալիքներ աղջիկների համար...'\n              },\n              ownProduct: {\n                title: 'Սեփական արտադրանք',\n                description: 'Միջազգային չափանիշերին համապատասխան, բարձրորակ փափուկ եւ ինտերակտիվ խաղալիքներ...'\n              },\n              isNew: {\n                title: 'Նորույթներ',\n                description: 'Պարբերաբար թարմացվող տեսականուն կարող եք ծանոթանալ ինչպես խանութ-սրահներում, այնպես էլ առցանց...'\n              },\n              all: {\n                title: 'Տեսականի',\n                description: 'Ցանկացած տարիքի երեխաների համար նախատեսված բազմատեսակ խաղեր եւ խաղալիքներ...'\n              },\n              percent: {\n                title: 'Զեղչեր',\n                description: 'Զեղչված տեսականուն կարող եք ծանոթանալ ինչպես խանութ սրահներում, այնպես էլ առցանց...'\n              },\n              bestSeller: {\n                title: 'Լավագույն վաճառք',\n                description: 'Լայն պահանջարկ ունեցող տեսականուն կարող եք ծանոթանալ ինչպես խանութ-սրահներում, այնպես էլ առցանց...'\n              }\n            };\n            titleDescriptionKey = 'all';\n            filter.searchWord = searchWord;\n\n            if (age) {\n              filter.age = age;\n              titleDescriptionKey = 'age';\n            }\n\n            if (gender) {\n              filter.gender = [gender];\n              titleDescriptionKey = gender;\n            }\n\n            if (brand) {\n              filter.brand = [brand];\n              titleDescriptionKey = 'ownProduct';\n            }\n\n            if (classification) {\n              filter.classification = [classification];\n              if (titleDescription[classification]) titleDescriptionKey = classification;\n            }\n\n            if (type) {\n              filter.type = [type];\n            }\n\n            if (meaning) {\n              filter.meaning = [meaning];\n            } // filter.price = [...keys.DEFAULT_PRICE];\n\n\n            state = store.getState();\n            isUserFilter = getIsUserFilter(state);\n            filters = selectCatalogFilters(state);\n\n            if (!isUserFilter) {\n              store.dispatch(resetCatalogFilterReducer());\n              store.dispatch(catalogFilterSetValues(_objectSpread(_objectSpread({}, filter), {}, {\n                filters: _objectSpread(_objectSpread({}, filters), {}, {\n                  searchWord: searchWord\n                })\n              })));\n            } else {\n              store.dispatch(catalogFilterSetValues(_objectSpread(_objectSpread({}, clearFilters(store.getState())), {}, {\n                isUserFilter: false,\n                filters: _objectSpread(_objectSpread({}, filters), {}, {\n                  searchWord: searchWord\n                })\n              })));\n            }\n\n            _context.next = 18;\n            return store.dispatch(catalogGet());\n\n          case 18:\n            return _context.abrupt(\"return\", {\n              titleDescription: titleDescription[titleDescriptionKey]\n            });\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nfunction mapStateToProps(_ref4) {\n  var _ref4$catalog = _ref4.catalog,\n      products = _ref4$catalog.products,\n      pagesCount = _ref4$catalog.pagesCount,\n      page = _ref4$catalog.page,\n      loading = _ref4$catalog.loading,\n      lang = _ref4.user.lang;\n  return {\n    products: products,\n    pagesCount: pagesCount,\n    page: page,\n    loading: loading,\n    lang: lang\n  };\n}\n\nexport default connect(mapStateToProps, {\n  toggleVisibilityAction: toggleVisibility,\n  resetCatalogFilterReducerAction: resetCatalogFilterReducer,\n  catalogGetAction: catalogGet\n})(Catalog);","map":null,"metadata":{},"sourceType":"module"}